import{r as j,j as e,f as t,i as K,t as Q,S as B,h as O}from"./index-BRBX7hDb.js";import{u as V,g as W,h as X,i as Y,b as ee,c as se,e as te}from"./Layout-KhibMNC7.js";import{u as I}from"./useAsync-BesWtCte.js";import{u as J,M as R}from"./DrawerButton-BjwC-AQC.js";import{U as ae}from"./UploadMany-oy2fHVGZ.js";import{N as re}from"./NotFound-D4QUBmsM.js";import{P as A,C as le}from"./ProductServices-B8dTtDEx.js";import{P as ie}from"./PageTitle-C0I8t3w2.js";import{P as _}from"./ProductDrawer-BF1TfJ3l.js";import{C as E}from"./CheckBox-nJsbTM8m.js";import{D as M}from"./DeleteModal-CqhPW0Ap.js";import{E as ne}from"./EditDeleteButton-BLUUhkxP.js";import{S as oe,B as de}from"./BulkActionDrawer-DmBfuJod.js";import{T as ce}from"./Tooltip-Be4V-BoV.js";import{A as xe,c as me}from"./browser-CmZe1AEk.js";import{a as S,n as U}from"./toast-BmuvtaoB.js";import{u as ge}from"./useDisableForDemo-8L6F_Yoc.js";import{T as he}from"./TableLoading-ItMVDN_h.js";import{A as pe}from"./AnimatedContent-BDApi7bC.js";import"./iconBase-MO_yqM0e.js";import"./logo-color-D4dEd9DP.js";import"./spinner-CkndCogW.js";import"./exportFromJSON-fDIoOtpr.js";import"./ParentCategory-b8eB83_s.js";import"./index-D6WZe_ds.js";import"./index.esm-DIUuZJ-3.js";import"./InputArea-D5SbBmG7.js";import"./LabelArea-B1eROtO8.js";import"./InputValue-Ur4soqKA.js";import"./useTranslationValue-BkQTMktR.js";import"./Uploader-DqKrMY9q.js";import"./tslib.es6-BfZZHrVl.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";import"./index-CBBKfmC5.js";import"./index.prod-DzGpE9S3.js";import"./AdminServices-DS-LzysT.js";import"./CouponServices-j8c0PyJg.js";import"./CurrencyServices-DdWWi0T6.js";import"./SwitchToggle-CNRwyEeq.js";const ue=({products:w,isCheck:m,setIsCheck:g})=>{const{title:v,serviceId:c,handleModalOpen:a,handleUpdate:C}=J(),{currency:f,showingTranslateValue:p,getNumberTwo:u}=V(),[y,T]=j.useState({}),k=s=>{const{id:o,checked:d}=s.target;g([...m,o]),d||g(m.filter(r=>r!==o))},D=s=>{T(o=>({...o,[s]:!o[s]}))},P=s=>{if(!s?.isCombination||!s?.variants||s.variants.length===0)return e.jsx("span",{className:"text-xs text-gray-400",children:"No variants"});const o=s.variants.filter(r=>r.variantType==="size"),d=y[s._id];return o.length===0?e.jsxs("span",{className:"text-xs text-gray-600",children:[s.variants.length," variant(s)"]}):e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>D(s._id),className:"flex items-center gap-1 px-2 py-1 text-xs font-medium text-brown-700 bg-brown-50 hover:bg-brown-100 dark:bg-brown-900 dark:text-brown-300 dark:hover:bg-brown-800 rounded transition-colors",children:[e.jsxs("span",{children:[o.length," Size Variant",o.length>1?"s":""]}),d?e.jsx(X,{className:"w-3 h-3"}):e.jsx(Y,{className:"w-3 h-3"})]}),d&&e.jsx("div",{className:"absolute z-50 mt-1 w-64 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 max-h-80 overflow-y-auto",children:e.jsx("div",{className:"p-2 space-y-2",children:o.map((r,x)=>e.jsxs("div",{className:"p-2 bg-brown-50 dark:bg-brown-900 rounded border border-brown-200 dark:border-brown-700",children:[e.jsx("div",{className:"font-semibold text-xs text-brown-800 dark:text-brown-200 mb-1",children:r.combination}),r.pricingTiers&&r.pricingTiers.length>0&&e.jsx("div",{className:"space-y-1",children:r.pricingTiers.map((i,b)=>e.jsxs("div",{className:"flex items-center justify-between text-xs bg-white dark:bg-gray-800 px-2 py-1 rounded",children:[e.jsxs("span",{className:"text-brown-600 dark:text-brown-400 font-medium",children:[i.quantity," pcs"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i.discount>0&&e.jsxs("span",{className:"bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 px-1.5 py-0.5 rounded text-xs font-semibold",children:[i.discount,"% off"]}),e.jsxs("span",{className:"font-semibold text-gray-700 dark:text-gray-300",children:[f," ",i.finalPrice.toFixed(2)]})]})]},b))})]},x))})})]})};return e.jsxs(e.Fragment,{children:[m?.length<1&&e.jsx(M,{id:c,title:v}),m?.length<2&&e.jsx(R,{children:e.jsx(_,{currency:f,id:c})}),e.jsx(t.TableBody,{children:w?.map((s,o)=>e.jsxs(t.TableRow,{children:[e.jsx(t.TableCell,{children:e.jsx(E,{type:"checkbox",name:s?.title?.en,id:s._id,handleClick:k,isChecked:m?.includes(s._id)})}),e.jsx(t.TableCell,{children:e.jsxs("div",{className:"flex items-center",children:[s?.image[0]?e.jsx(t.Avatar,{className:"hidden p-1 mr-2 md:block bg-gray-50 shadow-none",src:s?.image[0],alt:"product"}):e.jsx(t.Avatar,{src:"https://res.cloudinary.com/ahossain/image/upload/v1655097002/placeholder_kvepfp.png",alt:"product"}),e.jsx("div",{children:e.jsx("h2",{className:`text-sm font-medium ${s?.title.length>30?"wrap-long-title":""}`,children:p(s?.title)?.substring(0,28)})})]})}),e.jsx(t.TableCell,{children:e.jsx("span",{className:"text-sm",children:p(s?.category?.name)})}),e.jsx(t.TableCell,{children:P(s)}),e.jsx(t.TableCell,{children:e.jsxs("span",{className:"text-sm font-semibold",children:[f," ",s?.isCombination?(()=>{const d=s?.variants[0];return d?.variantType==="size"&&d?.pricingTiers?.length>0?u(s?.prices?.originalPrice):u(d?.originalPrice)})():u(s?.prices?.originalPrice)]})}),e.jsx(t.TableCell,{children:e.jsxs("span",{className:"text-sm font-semibold",children:[f," ",s?.isCombination?(()=>{const d=s?.variants[0];return d?.variantType==="size"&&d?.pricingTiers?.length>0?u(s?.prices?.price):u(d?.price)})():u(s?.prices?.price)]})}),e.jsx(t.TableCell,{children:e.jsx(K,{to:`/product/${s._id}`,className:"flex justify-center text-gray-400 hover:text-emerald-600",children:e.jsx(ce,{id:"view",Icon:W,title:Q("DetailsTbl"),bgColor:"#10B981"})})}),e.jsx(t.TableCell,{className:"text-center",children:e.jsx(oe,{id:s._id,status:s.status})}),e.jsx(t.TableCell,{children:e.jsx(ne,{id:s._id,product:s,isCheck:m,handleUpdate:C,handleModalOpen:a,title:p(s?.title)})})]},o+1))})]})},be={type:"object",properties:{categories:{type:"array"},image:{type:"array"},tag:{type:"array"},variants:{type:"array"},show:{type:"array"},status:{type:"string"},prices:{type:"object"},isCombination:{type:"boolean"},title:{type:"object"},productId:{type:"string"},slug:{type:"string"},category:{type:"object"},stock:{type:"number"},description:{type:"object"}},required:["categories","category","prices","title"]},fe=w=>{const m=new xe({allErrors:!0}),{setLoading:g,setIsUpdate:v}=j.useContext(B),[c]=j.useState([]),[a,C]=j.useState([]),[f,p]=j.useState(""),[u,y]=j.useState(!1),{handleDisableForDemo:T}=ge();return{data:w,filename:f,isDisabled:u,handleSelectFile:async r=>{r.preventDefault();const x=new FileReader,i=r.target?.files[0];i&&i.type==="application/json"?(p(i?.name),y(!0),x.readAsText(i,"UTF-8"),x.onload=b=>{const N=JSON.parse(b.target.result).map(l=>({categories:l.categories,image:l.image,barcode:l.barcode,tag:l.tag,variants:l.variants,status:l.status,prices:l.prices,isCombination:JSON.parse(l.isCombination.toLowerCase()),title:l.title,productId:l.productId,slug:l.slug,sku:l.sku,category:l.category,stock:l.stock,description:l.description}));C(N)}):i&&i.type==="text/csv"?(p(i?.name),y(!0),x.onload=async b=>{const h=b.target.result,l=(await me().fromString(h)).map(n=>({categories:JSON.parse(n.categories),image:JSON.parse(n.image),barcode:n.barcode,tag:JSON.parse(n.tag),variants:JSON.parse(n.variants),status:n.status,prices:JSON.parse(n.prices),isCombination:JSON.parse(n.isCombination.toLowerCase()),title:JSON.parse(n.title),productId:n.productId,slug:n.slug,sku:n.sku,category:JSON.parse(n.category),stock:JSON.parse(n.stock),description:JSON.parse(n.description)}));C(l)},x.readAsText(i)):(p(i?.name),y(!0),S("Unsupported file type!"))},serviceData:w,handleOnDrop:r=>{for(let x=0;x<r.length;x++)c.push(r[x].data)},handleUploadProducts:()=>{if(!T())if(c.length<1)S("Please upload/select csv file first!");else{if(T())return;A.addAllProducts(c).then(r=>{U(r.message)}).catch(r=>S(r.message))}},handleRemoveSelectFile:r=>{p(""),C([]),setTimeout(()=>y(!1),1e3)},handleUploadMultiple:r=>{if(!T())if(a.length>1){g(!0);let x=a.map(h=>m.validate(be,h));const i=h=>h===!0;x.every(i)?A.addAllProducts(a).then(h=>{v(!0),g(!1),U(h.message)}).catch(h=>{g(!1),S(h.message)}):(g(!1),S("Please enter valid data!"))}else g(!1),S("Please select a valid json, csv & xls file first!")}}},je=({setCategory:w})=>{const{t:m}=O(),{data:g}=I(le.getAllCategories),{showingTranslateValue:v}=V();return e.jsx(e.Fragment,{children:e.jsxs(t.Select,{onChange:c=>w(c.target.value),children:[e.jsx("option",{value:"All",defaultValue:!0,hidden:!0,children:m("Category")}),g?.map(c=>e.jsx("option",{value:c._id,children:v(c?.name)},c._id))]})})},ls=()=>{const{title:w,allId:m,serviceId:g,handleDeleteMany:v,handleUpdateMany:c}=J(),{t:a}=O(),{toggleDrawer:C,lang:f,currentPage:p,handleChangePage:u,searchText:y,category:T,setCategory:k,searchRef:D,handleSubmitForAll:P,sortedField:s,setSortedField:o,limitData:d}=j.useContext(B),{data:r,loading:x,error:i}=I(()=>A.getAllProducts({page:p,limit:d,category:T,title:y,price:s})),[b,h]=j.useState(!1),[N,l]=j.useState([]),n=()=>{h(!b),l(r?.products.map(F=>F._id)),b&&l([])},L=()=>{k(""),o(""),D.current.value=""},{serviceData:z,filename:H,isDisabled:q,handleSelectFile:$,handleUploadMultiple:Z,handleRemoveSelectFile:G}=fe(r?.products);return e.jsxs(e.Fragment,{children:[e.jsx(ie,{children:a("ProductsPage")}),e.jsx(M,{ids:m,setIsCheck:l,title:w}),e.jsx(de,{ids:m,title:"Products"}),e.jsx(R,{children:e.jsx(_,{id:g})}),e.jsxs(pe,{children:[e.jsx(t.Card,{className:"min-w-0 shadow-xs overflow-hidden bg-white dark:bg-gray-800 mb-5",children:e.jsx(t.CardBody,{className:"",children:e.jsxs("form",{onSubmit:P,className:"py-3 md:pb-0 grid gap-4 lg:gap-6 xl:gap-6 xl:flex",children:[e.jsx("div",{className:"flex-grow-0 sm:flex-grow md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsx(ae,{title:"Products",filename:H,isDisabled:q,totalDoc:r?.totalDoc,handleSelectFile:$,handleUploadMultiple:Z,handleRemoveSelectFile:G})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsxs(t.Button,{disabled:N.length<1,onClick:()=>c(N),className:"w-full rounded-md h-12 btn-gray text-gray-600",children:[e.jsx("span",{className:"mr-2",children:e.jsx(ee,{})}),a("BulkAction")]})}),e.jsx("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsxs(t.Button,{disabled:N?.length<1,onClick:()=>v(N,r.products),className:"w-full rounded-md h-12 bg-red-300 disabled btn-red",children:[e.jsx("span",{className:"mr-2",children:e.jsx(se,{})}),a("Delete")]})}),e.jsx("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsxs(t.Button,{onClick:C,className:"w-full rounded-md h-12",children:[e.jsx("span",{className:"mr-2",children:e.jsx(te,{})}),a("AddProduct")]})})]})]})})}),e.jsx(t.Card,{className:"min-w-0 shadow-xs overflow-hidden bg-white dark:bg-gray-800 rounded-t-lg rounded-0 mb-4",children:e.jsx(t.CardBody,{children:e.jsxs("form",{onSubmit:P,className:"py-3 grid gap-4 lg:gap-6 xl:gap-6 md:flex xl:flex",children:[e.jsxs("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:[e.jsx(t.Input,{ref:D,type:"search",name:"search",placeholder:"Search Product"}),e.jsx("button",{type:"submit",className:"absolute right-0 top-0 mt-5 mr-1"})]}),e.jsx("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsx(je,{setCategory:k,lang:f})}),e.jsx("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsxs(t.Select,{onChange:F=>o(F.target.value),children:[e.jsx("option",{value:"All",defaultValue:!0,hidden:!0,children:a("Price")}),e.jsx("option",{value:"low",children:a("LowtoHigh")}),e.jsx("option",{value:"high",children:a("HightoLow")}),e.jsx("option",{value:"published",children:a("Published")}),e.jsx("option",{value:"unPublished",children:a("Unpublished")}),e.jsx("option",{value:"status-selling",children:a("StatusSelling")}),e.jsx("option",{value:"status-out-of-stock",children:a("StatusStock")}),e.jsx("option",{value:"date-added-asc",children:a("DateAddedAsc")}),e.jsx("option",{value:"date-added-desc",children:a("DateAddedDesc")}),e.jsx("option",{value:"date-updated-asc",children:a("DateUpdatedAsc")}),e.jsx("option",{value:"date-updated-desc",children:a("DateUpdatedDesc")})]})}),e.jsxs("div",{className:"flex items-center gap-2 flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:[e.jsx("div",{className:"w-full mx-1",children:e.jsx(t.Button,{type:"submit",className:"h-12 w-full bg-brown-600 hover:bg-brown-700 rounded-lg shadow-sm hover:shadow-md",children:"Filter"})}),e.jsx("div",{className:"w-full mx-1",children:e.jsx(t.Button,{layout:"outline",onClick:L,type:"reset",className:"px-4 md:py-1 py-2 h-12 text-sm dark:bg-gray-700",children:e.jsx("span",{className:"text-black dark:text-gray-200",children:"Reset"})})})]})]})})})]}),x?e.jsx(he,{row:12,col:7,width:160,height:20}):i?e.jsx("span",{className:"text-center mx-auto text-red-500",children:i}):z?.length!==0?e.jsxs(t.TableContainer,{className:"mb-8 rounded-b-lg",children:[e.jsxs(t.Table,{children:[e.jsx(t.TableHeader,{children:e.jsxs("tr",{children:[e.jsx(t.TableCell,{children:e.jsx(E,{type:"checkbox",name:"selectAll",id:"selectAll",isChecked:b,handleClick:n})}),e.jsx(t.TableCell,{children:a("ProductNameTbl")}),e.jsx(t.TableCell,{children:a("CategoryTbl")}),e.jsx(t.TableCell,{children:"Variants Detail"}),e.jsx(t.TableCell,{children:a("PriceTbl")}),e.jsx(t.TableCell,{children:"Sale Price"}),e.jsx(t.TableCell,{className:"text-center",children:a("DetailsTbl")}),e.jsx(t.TableCell,{className:"text-center",children:a("PublishedTbl")}),e.jsx(t.TableCell,{className:"text-right",children:a("ActionsTbl")})]})}),e.jsx(ue,{lang:f,isCheck:N,products:r?.products,setIsCheck:l})]}),e.jsx(t.TableFooter,{children:e.jsx(t.Pagination,{totalResults:r?.totalDoc,resultsPerPage:d,onChange:u,label:"Product Page Navigation"})})]}):e.jsx(re,{title:"Product"})]})};export{ls as default};
