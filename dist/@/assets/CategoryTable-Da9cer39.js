import{r as g,S as G,h as J,j as e,f as d,i as P}from"./index-BRBX7hDb.js";import{u as $,S as Q,I as B,i as X,f as Z}from"./Layout-KhibMNC7.js";import{C as ee}from"./CheckBox-nJsbTM8m.js";import{T as O,D as se,u as ae,M as te}from"./DrawerButton-BjwC-AQC.js";import{D as re}from"./DeleteModal-CqhPW0Ap.js";import{T as ne}from"./ParentCategory-b8eB83_s.js";import{a as L,n as M}from"./toast-BmuvtaoB.js";import{u as le,E as V}from"./index.esm-DIUuZJ-3.js";import{I as ie}from"./InputArea-D5SbBmG7.js";import{L as k}from"./LabelArea-B1eROtO8.js";import{S as oe}from"./SwitchToggle-CNRwyEeq.js";import{T as de,S as ce}from"./BulkActionDrawer-DmBfuJod.js";import{U as me}from"./Uploader-DqKrMY9q.js";import{C as U}from"./ProductServices-B8dTtDEx.js";import{u as pe}from"./useTranslationValue-BkQTMktR.js";import{E as he}from"./EditDeleteButton-BLUUhkxP.js";const ge=(o,c)=>{const{isDrawerOpen:l,closeDrawer:f,setIsUpdate:m,lang:S}=g.useContext(G),[x,v]=g.useState({}),[b,N]=g.useState(""),[T,p]=g.useState(""),[w,D]=g.useState([]),[i,_]=g.useState("en"),[s,n]=g.useState(!0),[y,C]=g.useState(""),[A,j]=g.useState(!1),{handlerTextTranslateHandler:E}=pe(),{register:t,handleSubmit:h,setValue:a,clearErrors:u,reset:q,formState:{errors:z}}=le(),K=async({name:r,description:H})=>{try{j(!0);const I=await E(r,i,x?.name),Y=await E(H,i,x?.description),R={name:{...I,[i]:r},description:{...Y,[i]:H||""},parentId:b||void 0,parentName:y||"Home",icon:T,status:s?"show":"hide",lang:i};if(o){const F=await U.updateCategory(o,R);m(!0),j(!1),M(F.message),f(),q()}else{const F=await U.addCategory(R);m(!0),j(!1),M(F.message),f()}}catch(I){j(!1),L(I?I?.response?.data?.message:I?.message),f()}},W=r=>{_(r),Object.keys(x).length>0&&(a("name",x.name[r||"en"]),a("description",x.description[r||"en"]))};return g.useEffect(()=>{if(!l){v({}),a("name"),a("parentId"),a("parentName"),a("description"),a("icon"),p(""),n(!0),u("name"),u("parentId"),u("parentName"),u("description"),C("Home"),_(S),a("language",i),c!==void 0&&c[0]?._id!==void 0&&N(c[0]._id);return}o&&(async()=>{try{const r=await U.getCategoryById(o);r&&(v(r),a("name",r.name[i||"en"]),a("description",r.description[i||"en"]),a("language",i),a("parentId",r.parentId),a("parentName",r.parentName),C(r.parentName),N(r.parentId),p(r.icon),n(r.status==="show"))}catch(r){L(r?r.response.data.message:r.message)}})()},[o,a,l,i,u,c,S]),{register:t,handleSubmit:h,onSubmit:K,errors:z,imageUrl:T,setImageUrl:p,children:w,setChildren:D,published:s,setPublished:n,checked:b,setChecked:N,isSubmitting:A,selectCategoryName:y,setSelectCategoryName:C,handleSelectLanguage:W}},xe=({id:o,data:c})=>{const{t:l}=J(),{checked:f,register:m,onSubmit:S,handleSubmit:x,errors:v,imageUrl:b,setImageUrl:N,published:T,setPublished:p,setChecked:w,selectCategoryName:D,setSelectCategoryName:i,handleSelectLanguage:_,isSubmitting:s}=ge(o,c),{showingTranslateValue:n}=$(),y=`
  .rc-tree-child-tree {
    display: hidden;
  }
  .node-motion {
    transition: all .3s;
    overflow-y: hidden;
  }
`,C={motionName:"node-motion",motionAppear:!1,onAppearStart:t=>({height:0}),onAppearActive:t=>({height:t.scrollHeight}),onLeaveStart:t=>({height:t.offsetHeight}),onLeaveActive:()=>({height:0})},A=t=>{let h=[];for(let a of t)h.push({title:n(a.name),key:a._id,children:a.children.length>0&&A(a.children)});return h},j=(t,h)=>t._id===h?t:t?.children?.reduce((a,u)=>a??j(u,h),void 0),E=async t=>{if(t!==void 0)if(o){const h=await U.getCategoryById(t);if(o===t)return L("This can't be select as a parent category!");if(o===h.parentId)return L("This can't be select as a parent category!");{if(t===void 0)return;w(t);const a=c[0],u=j(a,t);i(n(u?.name))}}else{if(t===void 0)return;w(t);const h=c[0],a=j(h,t);i(n(a?.name))}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full relative p-6 border-b border-gray-100 bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:o?e.jsx(O,{register:m,title:l("UpdateCategory"),description:l("UpdateCategoryDescription")}):e.jsx(O,{register:m,title:l("AddCategoryTitle"),description:l("AddCategoryDescription")})}),e.jsx(Q,{className:"w-full md:w-7/12 lg:w-8/12 xl:w-8/12 relative dark:bg-gray-700 dark:text-gray-200",children:e.jsxs("form",{onSubmit:x(S),children:[e.jsxs("div",{className:"p-6 flex-grow scrollbar-hide w-full max-h-full pb-40",children:[e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(k,{label:l("Name")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(ie,{required:!0,register:m,label:"Category title",name:"name",type:"text",placeholder:l("ParentCategoryPlaceholder")}),e.jsx(V,{errorName:v.name})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(k,{label:l("Description")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(de,{register:m,label:"Description",name:"description",type:"text",placeholder:"Category Description"}),e.jsx(V,{errorName:v.description})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(k,{label:l("ParentCategory")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4 relative",children:[e.jsx(d.Input,{readOnly:!0,...m("parent",{required:!1}),name:"parent",value:D||"Home",placeholder:l("ParentCategory"),type:"text"}),e.jsxs("div",{className:"draggable-demo capitalize",children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:y}}),e.jsx(ne,{expandAction:"click",treeData:A(c),selectedKeys:[f],onSelect:t=>E(t[0]),motion:C,animation:"slide-up"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(k,{label:l("CategoryIcon")}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(me,{imageUrl:b,setImageUrl:N,folder:"category",targetWidth:238,targetHeight:238})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(k,{label:l("Published")}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(oe,{handleProcess:p,processOption:T})})]})]}),e.jsx(se,{id:o,title:"Category",isSubmitting:s})]})})]})},Ee=({data:o,lang:c,isCheck:l,categories:f,setIsCheck:m,useParamId:S,showChild:x})=>{const{title:v,serviceId:b,handleModalOpen:N,handleUpdate:T}=ae(),{showingTranslateValue:p}=$(),[w,D]=g.useState({}),i=s=>{D(n=>({...n,[s]:!n[s]}))},_=s=>{const{id:n,checked:y}=s.target;m([...l,n]),y||m(l.filter(C=>C!==n))};return e.jsxs(e.Fragment,{children:[l?.length<1&&e.jsx(re,{useParamId:S,id:b,title:v}),e.jsx(te,{children:e.jsx(xe,{id:b,data:o,lang:c})}),e.jsx(d.TableBody,{children:f?.map(s=>e.jsxs(d.TableRow,{className:"hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-150",children:[e.jsx(d.TableCell,{children:e.jsx(ee,{type:"checkbox",name:"category",id:s._id,handleClick:_,isChecked:l?.includes(s._id)})}),e.jsx(d.TableCell,{className:"font-semibold uppercase text-xs",children:s?._id?.substring(20,24)}),e.jsx(d.TableCell,{children:s?.icon?e.jsx(d.Avatar,{className:"hidden mr-3 md:block bg-gray-50 border border-gray-200 dark:bg-gray-700 dark:border-gray-600 shadow-sm p-1",src:s?.icon,alt:s?.parent}):e.jsx(d.Avatar,{src:"https://res.cloudinary.com/ahossain/image/upload/v1655097002/placeholder_kvepfp.png",alt:"product",className:"hidden p-1 mr-2 md:block bg-gray-50 shadow-none"})}),e.jsx(d.TableCell,{className:"font-medium text-sm",children:s?.children.length>0?e.jsxs(P,{to:`/categories/${s?._id}`,className:"text-brown-700 hover:text-brown-800 font-medium transition-colors duration-150",children:[p(s?.name),e.jsx(e.Fragment,{children:x&&e.jsxs(e.Fragment,{children:[" ",e.jsx("div",{className:"pl-2 mt-2 space-y-1.5",children:s?.children?.map(n=>e.jsx("div",{children:e.jsx(P,{to:`/categories/${n?._id}`,className:"text-blue-700",children:e.jsxs("div",{className:"flex text-xs items-center text-gray-600 dark:text-gray-400 hover:text-brown-600 dark:hover:text-brown-400 transition-colors",children:[e.jsx("span",{className:"text-xs text-brown-500 pr-2",children:e.jsx(B,{})}),e.jsx("span",{children:p(n.name)})]})})},n._id))})]})})]}):e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:p(s?.name)})}),e.jsx(d.TableCell,{className:"text-sm",children:s?.children&&s?.children.length>0?e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>i(s._id),className:"flex items-center space-x-2 text-brown-600 hover:text-brown-700 font-medium transition-all duration-200 hover:scale-105",children:[w[s._id]?e.jsx(X,{className:"w-4 h-4"}):e.jsx(Z,{className:"w-4 h-4"}),e.jsxs("span",{className:"text-xs",children:[s.children.length," ",s.children.length===1?"Subcategory":"Subcategories"]})]}),w[s._id]&&e.jsx("div",{className:"mt-2 ml-4 space-y-1.5 border-l-2 border-brown-300 dark:border-brown-600 pl-3 animate-slideDown",children:s.children.map(n=>e.jsxs("div",{className:"flex items-center text-xs hover:translate-x-1 transition-transform duration-200",children:[e.jsx("span",{className:"text-brown-400 pr-1.5",children:e.jsx(B,{})}),e.jsx(P,{to:`/categories/${n._id}`,className:"text-brown-600 hover:text-brown-800 dark:text-brown-400 dark:hover:text-brown-300 hover:underline",children:p(n.name)})]},n._id))})]}):e.jsx("span",{className:"text-gray-400 text-xs italic",children:"No subcategories"})}),e.jsx(d.TableCell,{className:"text-center",children:e.jsx(ce,{id:s._id,category:!0,status:s.status})}),e.jsx(d.TableCell,{children:e.jsx(he,{id:s?._id,parent:s,isCheck:l,children:s?.children,handleUpdate:T,handleModalOpen:N,title:p(s?.name)})})]},s._id))})]})};export{xe as C,Ee as a};
