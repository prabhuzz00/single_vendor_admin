import{A as ze,c as Ze}from"./browser-CmZe1AEk.js";import{d as _,u as $e}from"./Layout-KhibMNC7.js";import{c as le,g as de,r as a,u as Ge,S as He,L as Xe}from"./index-BRBX7hDb.js";import{u as ke}from"./useDisableForDemo-8L6F_Yoc.js";import{P as Ke,C as Qe,a as We,A as et}from"./ProductServices-B8dTtDEx.js";import{C as tt}from"./CouponServices-j8c0PyJg.js";import{C as st}from"./CurrencyServices-DdWWi0T6.js";import{a as l,n as D}from"./toast-BmuvtaoB.js";var pe={exports:{}};(function(L,T){(function(C,g){L.exports=g()})(le,function(){return function(C,g,y){g.prototype.isBetween=function(A,w,m,h){var b=y(A),S=y(w),O=(h=h||"()")[0]==="(",v=h[1]===")";return(O?this.isAfter(b,m):!this.isBefore(b,m))&&(v?this.isBefore(S,m):!this.isAfter(S,m))||(O?this.isBefore(b,m):!this.isAfter(b,m))&&(v?this.isAfter(S,m):!this.isBefore(S,m))}}})})(pe);var at=pe.exports;const ot=de(at);var me={exports:{}};(function(L,T){(function(C,g){L.exports=g()})(le,function(){return function(C,g,y){g.prototype.isToday=function(){var A="YYYY-MM-DD",w=y();return this.format(A)===w.format(A)}}})})(me);var nt=me.exports;const rt=de(nt),it={type:"object",properties:{_id:{type:"string"},name:{type:"object"},description:{type:"object"},icon:{type:"string"},status:{type:"string"}},required:["name"]},ct={type:"object",properties:{status:{type:"string"},title:{type:"object"},name:{type:"object"},variants:{type:"array"},option:{type:"string"},type:{type:"string"}},required:["name","title"]},ut={type:"object",properties:{title:{type:"object"},couponCode:{type:"string"},endTime:{type:"string"},discountPercentage:{type:"number"},minimumAmount:{type:"number"},productType:{type:"string"},logo:{type:"string"},discountType:{type:"object"},status:{type:"string"}},required:["title","couponCode","endTime","status"]},lt={type:"object",properties:{name:{type:"string"},email:{type:"string"}},required:["name","email"]},_t=L=>{const T=new ze({allErrors:!0}),[C,g]=a.useState(""),[y,A]=a.useState(""),[w,m]=a.useState(""),[h,b]=a.useState(""),[S,O]=a.useState(""),[v,fe]=a.useState(""),[x,k]=a.useState(""),[B,K]=a.useState(""),[j,Q]=a.useState(""),[ge,he]=a.useState(""),[F,Se]=a.useState(""),[V,ye]=a.useState(""),[Ce,we]=a.useState([]),[be,De]=a.useState([]),[Le,Te]=a.useState([]),[q,Ae]=a.useState(""),[Y,ve]=a.useState(""),[U,Pe]=a.useState(""),[z,Re]=a.useState(1),[Oe,W]=a.useState([]),[xe,je]=a.useState(""),[Fe,Ne]=a.useState(""),[_e,Be]=a.useState(""),[f,Z]=a.useState([]),[Ue,J]=a.useState(""),[Je,M]=a.useState(!1),[$,Me]=a.useState(""),[G]=a.useState([]),ee=a.useRef(""),te=a.useRef(""),se=a.useRef(""),ae=a.useRef(""),oe=a.useRef(""),H=a.useRef(""),ne=a.useRef(""),re=a.useRef(""),ie=a.useRef(""),Ee=a.useRef(""),ce=a.useRef("");_.extend(ot),_.extend(rt);const c=Ge(),{lang:P,setIsUpdate:R,setLoading:p}=a.useContext(He),{globalSetting:ue}=$e(),{handleDisableForDemo:X}=ke(),E=a.useMemo(()=>{const n=new Date;n.setDate(n.getDate()-U);let e=L?.map(t=>{const i=new Date(t?.updatedAt).toLocaleString("en-US",{timeZone:ue?.default_time_zone});return{...t,updatedDate:i==="Invalid Date"?"":i}});if(c.pathname==="/dashboard"){const t=e?.filter(u=>u.status==="Pending");we(t);const i=e?.filter(u=>u.status==="Processing");De(i);const s=e?.filter(u=>u.status==="Delivered");Te(s);const o=e?.filter(u=>_(u.createdAt).isToday())?.reduce((u,N)=>u+N.total,0);je(o);const qe=e?.filter(u=>_(u.createdAt).isBetween(new Date().setDate(new Date().getDate()-30),new Date))?.reduce((u,N)=>u+N.total,0);Ne(qe);const Ye=e?.reduce((u,N)=>u+N.total,0);Be(Ye)}return C&&(e=e.filter(t=>t.parent===C)),y==="Low"&&(e=e.sort((t,i)=>t.price<i.price&&-1)),y==="High"&&(e=e.sort((t,i)=>t.price>i.price&&-1)),w&&(e=e.filter(t=>t?.title?.toLowerCase().includes(w.toLowerCase()))),B&&(e=e.filter(t=>t?.title[P]?.toLowerCase()?.includes(B?.toLowerCase())||t?.attribute?.toLowerCase().includes(B?.toLowerCase()))),x&&(e=e.filter(t=>{const i=t?.name?.[P]?.toLowerCase()?.includes(x?.toLowerCase())||t?.category?.toLowerCase().includes(x?.toLowerCase()),s=t?.children?.some(d=>d?.name?.[P]?.toLowerCase()?.includes(x?.toLowerCase()));return i||s})),Y&&(e=e.filter(t=>t.role===Y)),h&&(e=e.filter(t=>t?.name[P]?.toLowerCase().includes(h.toLowerCase())||t?.phone?.toLowerCase().includes(h.toLowerCase())||t?.email?.toLowerCase().includes(h.toLowerCase()))),S&&(e=e?.filter(t=>t?.title[P]?.toLowerCase()?.includes(S?.toLowerCase())||t?.couponCode?.toLowerCase().includes(S?.toLowerCase()))),q&&(e=e.filter(t=>t.status===q)),v&&(e=e.filter(t=>t.contact.toLowerCase().includes(v.toLowerCase()))),U&&(e=e.filter(t=>_(t.createdAt).isBetween(n,new Date))),j&&(e=e.filter(t=>t?.name?.toLowerCase().includes(j.toLowerCase())||t?.iso_code?.toLowerCase().includes(j.toLowerCase()))),$&&(e=e.filter(t=>t?.name.toLowerCase().includes($.toLowerCase()))),F&&(e=e.filter(t=>t.name.toLowerCase().includes(F.toLowerCase())||t.iso_code.toLowerCase().includes(F.toLowerCase())||t.language_code.toLowerCase().includes(F.toLowerCase()))),V&&(e=e.filter(t=>t.iso_code.toLowerCase().includes(V.toLowerCase()))),e},[U,L,c.pathname,C,y,w,B,x,Y,h,S,q,v,j,$,F,V,H,ue?.default_time_zone,P]),I=20,Ie=E?.length,Ve=n=>{Re(n)};return a.useEffect(()=>{W(E?.slice((z-1)*I,z*I))},[E,z,I]),{userRef:se,searchRef:te,couponRef:ae,orderRef:oe,categoryRef:H,attributeRef:ne,pending:Ce,processing:be,delivered:Le,todayOrder:xe,monthlyOrder:Fe,totalOrder:_e,setFilter:g,setSortedField:A,setStatus:Ae,setRole:ve,time:U,zone:ge,setTime:Pe,taxRef:Ee,setZone:he,filename:Ue,countryRef:re,dataTable:Oe,serviceData:E,country:j,setSearchText:m,setCountry:Q,isDisabled:Je,languageRef:ie,currencyRef:ee,shippingRef:ce,setSearchUser:b,setDataTable:W,setCategoryType:k,handleChangePage:Ve,totalResults:Ie,resultsPerPage:I,handleOnDrop:n=>{for(let e=0;e<n.length;e++)G.push(n[e].data)},setSearchCoupon:O,setAttributeTitle:K,handleSelectFile:n=>{if(n.preventDefault(),X())return;const e=new FileReader,t=n.target?.files[0];t&&t.type==="application/json"?(J(t?.name),M(!0),console.log("if"),e.readAsText(t,"UTF-8"),e.onload=i=>{let s=JSON.parse(i.target.result),d=[];c.pathname==="/categories"&&(d=s.map(o=>({_id:o._id,id:o.id,status:o.status,name:o.name,description:o.description,parentName:o.parentName,parentId:o.parentId,icon:o.icon}))),c.pathname==="/attributes"&&(d=s.map(o=>({_id:o._id,status:o.status,title:o.title,name:o.name,variants:o.variants,option:o.option,type:o.type}))),c.pathname==="/coupons"&&(d=s.map(o=>({title:o.title,couponCode:o.couponCode,endTime:o.endTime,discountPercentage:o.discountPercentage,minimumAmount:o.minimumAmount,productType:o.productType,logo:o.logo,discountType:o.discountType,status:o.status}))),c.pathname==="/customers"&&(d=s.map(o=>({name:o.name,email:o.email,password:o.password,phone:o.phone}))),Z(d)}):t&&t.type==="text/csv"?(J(t?.name),M(!0),console.log("else if"),e.onload=async i=>{const s=i.target.result,d=await Ze().fromString(s);let o=[];c.pathname==="/categories"&&(o=d.map(r=>({_id:r._id,id:r.id,status:r.status,name:JSON.parse(r.name),description:JSON.parse(r.description),parentName:r.parentName,parentId:r.parentId,icon:r.icon}))),c.pathname==="/attributes"&&(o=d.map(r=>({status:r.status,title:JSON.parse(r.title),name:JSON.parse(r.name),variants:JSON.parse(r.variants),option:r.option,type:r.type}))),c.pathname==="/coupons"&&(o=d.map(r=>({title:JSON.parse(r.title),couponCode:r.couponCode,endTime:r.endTime,discountPercentage:r.discountPercentage?JSON.parse(r.discountPercentage):0,minimumAmount:r.minimumAmount?JSON.parse(r.minimumAmount):0,productType:r.productType,logo:r.logo,status:r.status}))),c.pathname==="/customers"&&(o=d.map(r=>({name:r.name,email:r.email,password:r.password,phone:r.phone}))),Z(o)},e.readAsText(t)):(J(t?.name),M(!0),l("Unsupported file type!"))},handleSubmitUser:n=>{n.preventDefault(),b(se.current.value)},handleSubmitForAll:n=>{n.preventDefault(),m(te.current.value)},handleSubmitCoupon:n=>{n.preventDefault(),O(ae.current.value)},handleSubmitOrder:n=>{n.preventDefault(),fe(oe.current.value)},handleSubmitCategory:n=>{n.preventDefault(),k(H.current.value)},handleSubmitAttribute:n=>{n.preventDefault(),K(ne.current.value)},handleUploadProducts:()=>{if(G.length<1)l("Please upload/select csv file first!");else{if(X())return;Ke.addAllProducts(G).then(n=>{D(n.message)}).catch(n=>l(n.message))}},handleSubmitCountry:n=>{n.preventDefault(),Q(re.current.value)},handleSubmitCurrency:n=>{n.preventDefault(),ye(ee.current.value)},handleSubmitShipping:n=>{n.preventDefault(),Me(ce.current.value)},handleSubmitLanguage:n=>{n.preventDefault(),Se(ie.current.value)},handleUploadMultiple:n=>{if(!X())if(f.length>1){if(c.pathname==="/categories"){p(!0);let e=f.map(s=>T.validate(it,s));const t=s=>s===!0;e.every(t)?Qe.addAllCategory(f).then(s=>{p(!1),R(!0),D(s.message)}).catch(s=>{p(!1),l(s?s.response.data.message:s.message)}):l("Please enter valid data!")}if(c.pathname==="/customers"){p(!0);let e=f.map(s=>T.validate(lt,s));const t=s=>s===!0;e.every(t)?We.addAllCustomers(f).then(s=>{p(!1),R(!0),D(s.message)}).catch(s=>{p(!1),l(s?s.response.data.message:s.message)}):l("Please enter valid data!")}if(c.pathname==="/coupons"){p(!0);let e=f.map(s=>T.validate(ut,s));const t=s=>s===!0;e.every(t)?tt.addAllCoupon(f).then(s=>{p(!1),R(!0),D(s.message)}).catch(s=>{p(!1),l(s?s.response.data.message:s.message)}):l("Please enter valid data!")}if(c.pathname==="/attributes"){p(!0);let e=f.map(s=>T.validate(ct,s));const t=s=>s===!0;e.every(t)?et.addAllAttributes(f).then(s=>{p(!1),R(!0),D(s.message)}).catch(s=>{p(!1),l(s?s.response.data.message:s.message)}):l("Please enter valid data!")}c.pathname==="/languages"&&Xe.addAllLanguage(f).then(e=>{R(!0),D(e.message)}).catch(e=>l(e?e.response.data.message:e.message)),c.pathname==="/currencies"&&st.addAllCurrency(f).then(e=>{R(!0),D(e.message)}).catch(e=>l(e?e.response.data.message:e.message))}else l("Please select a valid .JSON/.CSV/.XLS file first!")},handleRemoveSelectFile:n=>{J(""),Z([]),setTimeout(()=>M(!1),1e3)}}};export{rt as a,ot as i,_t as u};
